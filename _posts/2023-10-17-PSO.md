---
title: Particle Swarm Optimization(PSO) - (IN CONSTRUCTION, just a draft)
date: 2023-10-17 00:26:55 -0200
categories: [Nature-inspired Algorithms]
tags: [pso]     # TAG names should always be lowercase
---

# Description
In a collaborative project with Professor Michal Bildo at Brno University in the Czech Republic, made possible by the [UNIGOU](https://www.incbac.org/) program, I embarked on a journey to explore the world of Nature-Inspired Algorithms.

After a review of the literature and gaining insight into some of the principal nature-inspired algorithms, we decided to place a special emphasis on the Particle Swarm Optimization(PSO) technique. Our mission was to bring PSO to an educational graphical interface.

The softwares presented in this article were developed with the intention of offering students and teachers a chance to study, demonstrate, and visualize PSO; also allowing experimentation and personal adjustments. Here we bring two implementations of PSO: one to seek minima in 3D functions(simpler problem but with better visualization) and another to find best solutions to the complex Traveling Salesperson Problem(TSP).

# Theory
## PSO and its origin
PSO is a stochastic nature-inspired optimization method based on swarm, it was introduced by Eberhart and Kennedy in 1995. PSO mimics the collective behavior of some animals and is used to find optimal solutions to complex problems by iteratively adjusting a population of potential solutions based on their fitness. PSO can be applied to various domains, including the optimization of mathematical functions and solving combinatorial problems like the Traveling Salesperson Problem(TSP) as we will see in the following.

As commented above, PSO draws its inspiration from natural phenomena, particularly the collective behavior of some animals like birds and fishes for example:

- **Flocking Behavior of Birds:** Birds in a flock exhibit coordinated movement, adjusting their positions based on the behavior of neighboring birds. This collective behavior helps the flock optimize its path and react to environmental changes.

- **Schooling Behavior of Fish:** Similar to birds, fish in a school demonstrate collective behavior in their underwater journeys. They move as a group, responding to the movements and cues of other fish. This synchronized behavior allows fish to find optimal routes and adapt to changing conditions in their aquatic environment.

In PSO, individual solutions represented as particles, explore a multidimensional search space while adjusting their positions based on the performance of other particles. This mimics the way birds, fishes and other animals collectively adapt and optimize their trajectories in response to their peers.

The beauty of PSO lies in its ability to translate these natural principles into an effective optimization technique, making it a valuable tool for solving complex problems across various domains and **deepening our appreciation for nature**.

## Understanding PSO algorithm
PSO operates on the principles of swarm intelligence, and its key components include:

1. **Particles:** In PSO, each potential solution is represented as a particle in a search space. These particles explore the space to find the optimal solution.

2. **Fitness Function:** The fitness function is the metric for assessing the quality of a solution found by the particle during the exploration. It varies according to the problem.

3. **Social Influence:** Particles are influenced by the collective knowledge of the swarm. The social influence guides particles toward the global best solution. In general, this coefficient is responsible for the convergence of the algorithm.

4. **Cognitive Influence:** Each particle maintains its own historical best solution. The cognitive influence guides particles toward their individual best solutions.

5. **Inertia Influence:** The inertia weight balances the trade-off between global exploration and local exploitation. It helps particles regulate their movement within the search space.

An classical example of an equations to govern the particles movement in PSO are as follows:

- **Velocity Update:** The velocity of each particle is updated at each iteration based on its current velocity, cognitive influence, and social influence.
    ```markdown
    v_i(t+1) = inertia_w * v_i(t) + cognitive_w * rand1 * (pBest_i - x_i(t)) + social_w * rand2 * (gBest - x_i(t))
    ```
    Where:
    - `x_i(t)` is the current position of particle `i` at time `t`.
    - `v_i(t)` is the current velocity of particle `i` at time `t`.
    - `v_i(t+1)` is the updated velocity of particle `i` at time `t+1`.
    - `social_w` is the social weight.
    - `cognitive_w` is the cognitive weight.
    - `inertia_w` is the inertia weight.
    - `rand1` and `rand2` are random values between 0 and 1.
    - `pBest_i` is the best-known position of particle `i`.
    - `gBest` is the global best-known position in the swarm.

- **Position Update:** The position of each particle is updated based on its velocity.
    ```markdown
    x_i(t+1) = x_i(t) + v_i(t+1)
    ```
    - `x_i(t+1)` is the updated position of particle `i` at time `t+1`.

These equations govern the movement of particles within the search space, enabling PSO to search for optimal solutions through collective behavior and iterative adjustments.

To implement the PSO algorithm, as exemplified in the following examples, the key steps entail creating a pertinent set of particles and fitness function to represent the problem. Then, it is just keep updating the particles' positions and evaluating their fitness values iterativelly in accordance with the equations mentioned above(or suitable adaptations), until the algorithm converges or completes a predefined number of iterations.

# Practice

## Finding Minimum of 3D Functions

In this example, we utilize PSO to discover the minimum of 3D functions. The implementation can be found here: [PSO-min-3d-functions](https://github.com/HitaloCesar/PSO-min-3d-functions). Feel free to customize the code as needed. The user interface is designed to accommodate various parameter variations.

![pso-min-func_gif](../../assets/gifs/pso-min-func.gif)

### Input:
- Select a predefined function from a range of classical optimization functions based on [this list](http://www.sfu.ca/~ssurjano/optimization.html).
- Input your custom function, following the Python w/numpy format as demonstrated in the following example: `np.cos(np.sqrt(x**2 + y**2))*(x+y)`.
- Define the function range on the X and Y axes.
- Define the number of particles.
- Define the number of iterations.
- Set the inertia weight.
- Set the cognitive weight.
- Set the social weight.
- Set the initial velocity in the X-axis.
- Set the initial velocity in the Y-axis.

### Output:
- The best solution found.
- The execution time.
- The animation of particles reaching the result(essential for the educational aspect).

### About the Code

The code is structured into three simple components:

**main.py**
- **TkInter UI**: Responsible for creating the user interface using TkInter. It allows users to interact with the PSO algorithm and set various parameters.
- **Animation**: It includes methods for visualizing the PSO process.
- **Integration**: Connects the inputs of the UI to the other components and present the results provided by the other components to the TkInter UI.

**particle.py**
- **Particle Definition**: This module defines the properties and behavior of individual particles used in the PSO algorithm to find the minimum of a 3d function.

**pso.py**
- **PSO Algorithm**: This module contains the PSO algorithm implementation.

To start it, run "python3 main.py". To get more details about the implementation, please visit the [source code](https://github.com/HitaloCesar/PSO-min-3d-functions). If you have any questions or suggestions, feel free to contact me.

### Suggested Reflections

While exploring this interface, if this is your first interaction with PSO and you haven't quite grasped how it works yet, try adjusting the parameters to observe its behavior and consider the following questions:

- What occurs when you set the cognitive weight to 0?
- What occurs when you set the social weight to 0?
- What occurs when you set the inertia weight to 0?
- What happens when you significantly increase the number of particles?
- What happens if you set an exceptionally high initial velocity?
- Do parameters that perform well with one type of function also perform well with all other functions?

Conducting experiments and contemplating this kind of questions can help you understanding the concept of PSO.

## Travelling Salesperson Problem(TSP)

# Notes about the educational interface development
One of my primary responsibilities during this academic collaboration was to create an educational interface aimed at helping students grasp the concepts of Particle Swarm Optimization(PSO) and its practical application in solving the Traveling Salesperson Problem(TSP).

While implementing the TSP interface, I faced a significant challenge in creating a didactic visualization method for illustrating the TSP problem being solved by PSO. After much exploration, I found that the most effective representation was to showcase the evolving best route as found by the current best particle. The TSP, given its complexity as an optimization problem, presents challenges due its multidimensional representation.

To provide a more didactic approach and address a problem with greater visualization potential, I also designed an interface for locating minimum points within three-dimensional functions using PSO. This interface features a variety of classical optimization functions for straightforward testing and enables users to input their own custom functions for experimentation.

# Drafts to write later

[Code](https://github.com/HitaloCesar/TSP-UNIGOU) - needs a little refactor in some parts

Might create a video showing

Show details about the implementation

Say about dependencies

Better explain: Understanding PSO algorithm

<img src="../../assets/images/tsp_pso_ui.png" alt="tsp_pso_ui" height="600" width="600" />

Say about circular disposure for didatic

<img src="../../assets/images/min_func_pso_ui.png" alt="min_func_pso_ui" height="600" width="600" />

<img src="../../assets/images/min_func_pso_solution.png" alt="min_func_pso_solution" height="600" width="600" />

Might substitute for a gif
